10 ' SOUND TEST by KAZUTOMO
20 'syokisettei
30 GOSUB 300
40 GOSUB 500
90 'mainloop
100 I$=INKEY$:ST=STICK(0)
110 IF ST=1 THEN GOSUB 3000
120 GOSUB 1000:'key
140 GOSUB 1200:'keisan
160 GOSUB 1400:'hyouji
180 IF (PL=1) THEN GOSUB 1600:'otowo narasu
200 GOTO 100
300 'syokisettei
310 DEFINTA-Z:CLS:SCREEN 1,,0:WIDTH 32:KEYOFF:COLOR 15,4,7
320 C1=100:C2=300:C3=400:NS=16:BN!=0:CALL IOTPUT("device/analog/out",0)
330 DIM S$(8):S$(1)="10":S$(2)="1":S$(3)="1":S$(4)="1":S$(5)="0":S$(6)="0":S$(7)="0"
340 S$(0)=S$(1)+S$(2)+S$(3)+S$(4)+S$(5)+S$(6)+S$(7)
350 N1=16:N2=16:N3=16:EN!=5000:EV=14:PL=0
360 DIM OT(95):DIM CH$(11):DIM M(1):DIM M$(1)
370 FOR I=0 TO 95:READ D$:OT(I)=VAL("&H"+D$):NEXT
380 SD=4:TH=7:CX=0:M=0:CY=CX+4:CZ=CX+7:M(0)=0:M(1)=-1:M$(0)=" ":M$(1)="m"
390 FOR I=0 TO 11:READ D$:CH$(I)=D$:NEXT
400 RETURN
500 'mojihyouji
510 LOCATE 0,0:PRINT "SOUND TEST by KAZUTOMO";
520 LOCATE 2,1:PRINT "Ch 1     (Q-W)";
530 LOCATE 3,2:PRINT "SOUND 0,";
540 LOCATE 3,3:PRINT "SOUND 1,";
550 LOCATE 2,4:PRINT "Ch 2     (E-R)";
560 LOCATE 3,5:PRINT "SOUND 2,";
570 LOCATE 3,6:PRINT "SOUND 3,";
580 LOCATE 2,7:PRINT "Ch 3     (T-Y)";
590 LOCATE 3,8:PRINT "SOUND 4,";
600 LOCATE 3,9:PRINT "SOUND 5,";
610 LOCATE 2,10:PRINT "NOISE    (U-I)";
620 LOCATE 3,11:PRINT "SOUND 6,";
630 LOCATE 2,12:PRINT "Ch ON/OFF (Z)";
640 LOCATE 3,13:PRINT "SOUND 7,";
650 LOCATE 2,15:PRINT "VOLUME   (8:A-S,9:D-F,10:G-H)";
660 LOCATE 3,16:PRINT "SOUND 8,";
670 LOCATE 3,17:PRINT "SOUND 9,";
680 LOCATE 3,18:PRINT "SOUND10,";
690 LOCATE 2,19:PRINT "ENV freq (J-K)";
700 LOCATE 3,20:PRINT "SOUND11,";
710 LOCATE 3,21:PRINT "SOUND12,";
720 LOCATE 2,22:PRINT "ENV ptn  (O-P)";
730 LOCATE 3,23:PRINT "SOUND13,";
740 LOCATE 13,13:PRINT "&B"+S$(0);
750 LOCATE 17,4:PRINT " CHORD MODE(^)";
760 LOCATE 18,10:PRINT CHR$(1);CHR$(70)+"100MODE(RET)";
800 RETURN
1000 'KEY
1010 IF I$="" THEN RETURN
1020 IF I$="z" THEN RETURN 2200
1030 IF I$=" " THEN PL=1
1040 IF I$="\" THEN N1=0:N2=0:N3=0
1050 IF I$=CHR$(13) THEN RETURN 4000
1060 C1=C1+(I$="q")*-(C1>0)-(I$="w")*-(C1<4095)
1070 C2=C2+(I$="e")*-(C2>0)-(I$="r")*-(C2<4095)
1080 C3=C3+(I$="t")*-(C3>0)-(I$="y")*-(C3<4095)
1090 NS=NS+(I$="u")*-(NS>0)-(I$="i")*-(NS<31)
1100 N1=N1+(I$="a")*-(N1>0)-(I$="s")*-(N1<16)
1110 N2=N2+(I$="d")*-(N2>0)-(I$="f")*-(N2<16)
1120 N3=N3+(I$="g")*-(N3>0)-(I$="h")*-(N3<16)
1130 EN!=EN!+(I$="j")*-(EN!>0)-(I$="k")*-(EN!<65535!)
1140 EV=EV+(I$="o")*-(EV>0)-(I$="p")*-(EV<15)
1150 PL=1
1160 RETURN
1200 'keisan
1210 'Ch1~3
1220 S0=C1 MOD 256
1230 S1=C1 \ 256
1240 S2=C2 MOD 256
1250 S3=C2 \ 256
1260 S4=C3 MOD 256
1270 S5=C3 \ 256
1300 'EN!
1310 E1=EN!-INT(EN!/256)*256
1320 E2=FIX(EN!/256)
1330 RETURN
1400 'hyouji
1410 LOCATE 12,2:PRINT S0;"  ";
1420 LOCATE 12,3:PRINT S1;"  ";
1430 LOCATE 12,5:PRINT S2;"  ";
1440 LOCATE 12,6:PRINT S3;"  ";
1450 LOCATE 12,8:PRINT S4;"  ";
1460 LOCATE 12,9:PRINT S5;"  ";
1470 LOCATE 12,11:PRINT NS;"  ";
1480 LOCATE 12,16:PRINT N1;"  ";
1490 LOCATE 12,17:PRINT N2;"  ";
1500 LOCATE 12,18:PRINT N3;"  ";
1510 LOCATE 12,20:PRINT E1;"  ";
1520 LOCATE 12,21:PRINT E2;"  ";
1530 LOCATE 12,23:PRINT EV;"  ";
1540 RETURN
1600 'otowo narasu
1610 SOUND 6,NS
1620 SOUND 8,N1
1630 SOUND 9,N2
1640 SOUND 10,N3
1650 SOUND 11,E1
1660 SOUND 12,E2
1670 SOUND 13,EV
1680 SOUND 0,S0
1690 SOUND 1,S1
1700 SOUND 2,S2
1710 SOUND 3,S3
1720 SOUND 4,S4
1730 SOUND 5,S5
1735 PL=0
1740 RETURN
2200 'SOUND7
2210 LOCATE 1,14:PRINT"Ch ON/OFF       XCVBNM"
2220 CH$=INKEY$
2230 IF CH$="x" THEN S$(2)=BIN$((VAL(S$(2))+1)MOD 2)
2240 IF CH$="c" THEN S$(3)=BIN$((VAL(S$(3))+1)MOD 2)
2250 IF CH$="v" THEN S$(4)=BIN$((VAL(S$(4))+1)MOD 2)
2260 IF CH$="b" THEN S$(5)=BIN$((VAL(S$(5))+1)MOD 2)
2270 IF CH$="n" THEN S$(6)=BIN$((VAL(S$(6))+1)MOD 2)
2280 IF CH$="m" THEN S$(7)=BIN$((VAL(S$(7))+1)MOD 2)
2300 S$(0)=S$(1)+S$(2)+S$(3)+S$(4)+S$(5)+S$(6)+S$(7)
2310 LOCATE 13,13:PRINT "&B"+S$(0)
2320 IF CH$="z" THEN 2400
2350 GOTO 2220
2400 LOCATE 1,14:PRINT"                      "
2410 S7=VAL("&B"+S$(0))
2420 SOUND 7,S7
2430 GOTO 90
3000 'Chord mode
3010 LOCATE 17,4:PRINT "*"
3015 LOCATE 18,5:PRINT "Chord";
3017 LOCATE 18,7:PRINT "Octave";
3018 FOR I=0 TO 200:NEXT
3020 ST=STICK(0)
3030 IF ST=1 THEN 3300
3031 BN!=0:FOR I=0 TO 9
3032 CALL IOTGET("device/analog/in",AN)
3033 BN!=BN!+AN:NEXT
3034 CN=BN!/10
3039 IF CN=AM THEN 3020
3040 CX=87-CN\47
3050 M=(M-(ST=5))AND1
3060 CY=CX+SD:CZ=CX+TH+M(M)
3070 S0=OT(CX) MOD 256
3080 S1=OT(CX) \ 256
3090 S2=OT(CY) MOD 256
3100 S3=OT(CY) \ 256
3110 S4=OT(CZ) MOD 256
3120 S5=OT(CZ) \ 256
3130 SOUND 0,S0
3140 SOUND 1,S1
3150 SOUND 2,S2
3160 SOUND 3,S3
3170 SOUND 4,S4
3180 SOUND 5,S5
3190 AA=CX MOD 12:BB=CX \ 12
3200 LOCATE 20,6:PRINT CH$(AA)+"  "
3210 LOCATE 23,6:PRINT M$(M)
3220 LOCATE 19,8:PRINT BB+1
3230 CM=CN:GOTO 3020
3300 LOCATE 17,4:PRINT " ";
3310 FOR I=5 TO 8
3320 LOCATE 18,I:PRINT"      ";:NEXT
3330 C1=OT(CX):C2=OT(CY):C3=OT(CZ):PL=1
3340 RETURN 160
4000 'Key +-100MODE
4010 LOCATE 17,10:PRINT "*";
4020 FOR I=0 TO 100:NEXT
4030 I$=INKEY$
4040 IF I$="" THEN 4030
4050 C1=C1+((I$="q")*-(C1>100))*100-((I$="w")*-(C1<3995))*100
4060 C2=C2+((I$="e")*-(C2>100))*100-((I$="r")*-(C2<3995))*100
4070 C3=C3+((I$="t")*-(C3>100))*100-((I$="y")*-(C3<3995))*100
4080 NS=NS+(I$="u")*-(NS>0)-(I$="i")*-(NS<31)
4090 N1=N1+(I$="a")*-(N1>0)-(I$="s")*-(N1<16)
4100 N2=N2+(I$="d")*-(N2>0)-(I$="f")*-(N2<16)
4110 N3=N3+(I$="g")*-(N3>0)-(I$="h")*-(N3<16)
4120 EN!=EN!+((I$="j")*-(EN!>100))*100-((I$="k")*-(EN!<65435!))*100
4130 EV=EV+(I$="o")*-(EV>0)-(I$="p")*-(EV<15)
4140 GOSUB 1200
4150 GOSUB 1400
4160 GOSUB 1600
4170 IF I$=CHR$(13) THEN 4190
4180 GOTO 4030
4190 LOCATE 17,10:PRINT " "
4200 PL=1:GOTO 90
9990 'ontei
10000 DATA D5D,C9C,BE7,B3C,A9B,A02,973,8EB,86B,7F2,780,714
10010 DATA 6AF,64E,5F4,59E,54E,501,4BA,476,436,3F9,3C0,38A
10020 DATA 357,327,2FA,2CF,2A7,281,25D,23B,21B,1FD,1E0,1C5
10030 DATA 1AC,194,17D,168,153,140,12E,11D,10D,FE,F0,E3
10040 DATA D6,CA,BE,B4,AA,A0,97,8F,87,7F,78,71
10050 DATA 6B,65,5F,5A,55,50,4C,47,43,40,3C,39
10060 DATA 35,32,30,2D,2A,28,26,24,22,20,1E,1C
10070 DATA 1B,19,18,16,15,14,13,12,11,10,F,E
10090 'Chord
10100 DATA C,C#,D,D#,E,F,F#,G,G#,A,A#,B